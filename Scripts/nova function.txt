CREATE OR REPLACE FUNCTION public.pessoa_existe(
    cpf_input character varying,
    nome_input character varying,
    email_input character varying,
    telefone_input character varying)
RETURNS boolean
LANGUAGE 'plpgsql'
COST 100
VOLATILE PARALLEL UNSAFE
AS $BODY$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM cliente
        WHERE cpf = regexp_replace(cpf_input, '[^0-9]', '', 'g')
          OR nome = nome_input
          OR email = email_input
          OR telefone = telefone_input
    );
END;
$BODY$;

ALTER FUNCTION public.pessoa_existe(character varying, character varying, character varying, character varying)
    OWNER TO postgres;




SELECT pessoa_existe('43300674808')




antigo:


-- FUNCTION: public.pessoa_existe(character varying)

-- DROP FUNCTION IF EXISTS public.pessoa_existe(character varying);

CREATE OR REPLACE FUNCTION public.pessoa_existe(
	cpf_input character varying)
    RETURNS character varying
    LANGUAGE 'plpgsql'
    COST 100
    VOLATILE PARALLEL UNSAFE
AS $BODY$
DECLARE
	cpf_cliente VARCHAR;
BEGIN
	SELECT cpf
	INTO cpf_cliente
	FROM cliente
	WHERE cpf = cpf_input;

	RETURN cpf_cliente;
END;
$BODY$;

ALTER FUNCTION public.pessoa_existe(character varying)
    OWNER TO postgres;
